(this["webpackJsonpvocation-frontend"]=this["webpackJsonpvocation-frontend"]||[]).push([[36],{1063:function(e,t,a){},1272:function(e,t,a){"use strict";a.r(t);var n=a(4),s=a(5),c=a(10),o=a(9),i=a(3),r=a(11),l=a(0),d=a.n(l),h=a(407),u=a.n(h),p=a(80),m=a(81),b=function(e){function t(){return Object(n.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(r.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return d.a.createElement("li",{className:"main-con-list",onClick:this.props.openChat},d.a.createElement("div",{className:"con-list-left"},d.a.createElement("div",{className:"list-img"},d.a.createElement("img",{src:this.props.contact.profile_picture.src,alt:"Hi"}))),d.a.createElement("div",{className:"con-list-right"},d.a.createElement("div",{className:"con-list-meta"},d.a.createElement("div",{className:"con-list-body-author"}," ",d.a.createElement("strong",null," ",this.props.contact.full_name)),d.a.createElement("div",{className:"con-list-body-timestamp"},this.props.contact.live)),d.a.createElement("div",{className:"con-list-content"},d.a.createElement("div",{className:"con-list-in"},d.a.createElement("span",{className:"con-list-in-l"},"Email:"),d.a.createElement("div",{className:"con-listi-in-r"}," ",this.props.contact.email)),d.a.createElement("div",{className:"con-list-in"},d.a.createElement("span",{className:"con-list-in-l"},"Phone:"),d.a.createElement("div",{className:"con-listi-in-r"}," ",this.props.contact.primary_phone_number)))))}}]),t}(d.a.PureComponent),v=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).state={keyword:"",is_open:!0},a.searchUserByKey=a.searchUserByKey.bind(Object(i.a)(a)),a.openBox=a.openBox.bind(Object(i.a)(a)),a}return Object(r.a)(t,e),Object(s.a)(t,[{key:"searchUserByKey",value:function(e){this.setState({keyword:e.target.value})}},{key:"openBox",value:function(){this.setState({is_open:!this.state.is_open})}},{key:"render",value:function(){var e=this;return d.a.createElement("ul",{className:"body-main-con-mid"},this.props.contacts.map((function(t,a){return"active"===t.status&&(t.full_name.toLowerCase().includes(e.state.keyword.toLowerCase())||t.email.toLowerCase().includes(e.state.keyword.toLowerCase()))?d.a.createElement(b,{keyword:e.setState.keyword,key:a,contact:t,delete:function(){return e.props.delete(t.contact_id)},openChat:function(){return e.props.openChat(t.id)},archive:function(){return e.props.archive(t.contact_id)},active:function(){return e.props.active(t.contact_id)},block:function(){return e.props.block(t.contact_id)},unblock:function(){return e.props.unblock(t.contact_id)}}):null})))}}]),t}(d.a.PureComponent),g=a(732),y=a.n(g),f=a(746),_=a.n(f),E=a(741),k=a.n(E),C=a(742),O=a(16),j=a(7),S=function(e){function t(){return Object(n.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(r.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"onError",value:function(e){console.log(e,"Error!!!")}},{key:"render",value:function(){var e=this,t=O.a.isSigned();return d.a.createElement("ul",{id:"chat-messages-lists_"+this.props.chatUser},t?this.props.chat_history.map((function(t,a){return d.a.createElement("li",{key:a},d.a.createElement("div",{className:t.sender_id===Number(Number(Object(j.i)("user_id")))?"user-comment-middle":"admin-comment-area  user-comment-middle"},d.a.createElement("div",{className:"user-comment-middle-inner"},d.a.createElement("p",null,"text"===t.type?d.a.createElement(k.a,{properties:{target:"_blank",style:{fontWeight:"bold"}}},d.a.createElement(C.EmojioneV4,{svg:"true",size:128,text:t.message})):d.a.createElement("a",{download:!0,href:t.url},"file"===t.type?d.a.createElement("div",null,d.a.createElement(p.a,{icon:m.o}),d.a.createElement("span",null,t.message)):d.a.createElement("img",{className:"chat_preview_image",src:t.url,alt:"chat preview"})))),t.final_read_chat?d.a.createElement("div",null,d.a.createElement(p.a,{icon:m.M,className:"final_read_message"}),e.props.is_typing?d.a.createElement("div",{className:"typing-indicator"},d.a.createElement("span",null),d.a.createElement("span",null),d.a.createElement("span",null)):null):null))})):d.a.createElement("label",null,"Please Login to chat with Homeowner"))}}]),t}(d.a.PureComponent),x=a(199),w=a(15),N=!0,U=new u.a("ccd81a8b36efcabe5a7b",{cluster:"mt1",encrypted:!0,disableStats:!0}),B=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).state={is_open:!0,message:"",chat_history:[],file:null,uploading_progress:0,uploading:!1,is_typing:!1,kbactive:!1},a.chatKeyPress=a.chatKeyPress.bind(Object(i.a)(a)),a.chatKeyChange=a.chatKeyChange.bind(Object(i.a)(a)),a.openBox=a.openBox.bind(Object(i.a)(a)),a.fileChange=a.fileChange.bind(Object(i.a)(a)),a.handlePaste=a.handlePaste.bind(Object(i.a)(a)),a.uploadFileFromClipboard=a.uploadFileFromClipboard.bind(Object(i.a)(a)),a.handleSendMessage=a.handleSendMessage.bind(Object(i.a)(a)),a.handleTogglekbactive=a.handleTogglekbactive.bind(Object(i.a)(a)),a}return Object(r.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;x.a.getMessages(this.props.user_id,this.props.my_id).then((function(t){if(t){e.setState({chat_history:t});var a=document.getElementById("chat-messages_"+e.props.contactUser.id),n=document.getElementById("chat-messages-lists_"+e.props.contactUser.id);n&&n.clientHeight&&(a.scrollTop=n.clientHeight)}else w.a.showError("Get messages")}));var t,a=U.subscribe("chat_"+this.props.my_id);a.bind("message_read",(function(t){var a=e.state.chat_history;a.forEach((function(e,n){e.id===t.message_id?a[n].final_read_chat=1:a[n].final_read_chat=0}))})),a.bind("is_typing",(function(a){if(a.typing_user===e.props.contactUser.id){e.setState({is_typing:!0});var n=e;clearTimeout(t),t=setTimeout((function(){n.setState({is_typing:!1})}),900)}})),a.bind("App\\Events\\MessageSent",(function(t){var a=e.state.chat_history;if(t.message.message.sender_id===e.props.contactUser.id&&(a.push(t.message.message),e.props.isActive&&e.state.is_open)){var n={message_id:t.message.message};x.a.readChatMessage(n).then((function(e){e||w.a.showError("Read chat message")}))}e.setState({chat_history:a},(function(){var t=document.getElementById("chat-messages_"+e.props.contactUser.id),a=document.getElementById("chat-messages-lists_"+e.props.contactUser.id);a&&a.clientHeight&&(t.scrollTop=a.clientHeight)}))}))}},{key:"componentDidUpdate",value:function(e,t){0===t.chat_history.length&&this.chatBodyScrollTop()}},{key:"componentWillUnmount",value:function(){U.unsubscribe("chat_"+this.props.my_id),this.setState({is_open:!1})}},{key:"handlePaste",value:function(e){for(var t=0;t<e.clipboardData.items.length;t++){var a=e.clipboardData.items[t];-1!==a.type.indexOf("image")&&this.uploadFileFromClipboard(a.getAsFile())}}},{key:"chatBodyScrollTop",value:function(){document.getElementById("chat-messages_"+this.props.contactUser.id).scrollTop=document.getElementById("chat-messages-lists_"+this.props.contactUser.id).clientHeight}},{key:"handleSendMessage",value:function(e){var t=this;e.preventDefault();var a=this.state.chat_history;if(a.push({user_id:this.props.contactUser.id,sender_id:this.props.my_id,type:"text",message:this.state.message,sender_profile_picture:this.props.my_profile_pic}),this.setState({chat_history:a},(function(){var e=document.getElementById("chat-messages_"+t.props.contactUser.id),a=document.getElementById("chat-messages-lists_"+t.props.contactUser.id);a&&a.clientHeight&&(e.scrollTop=a.clientHeight)})),this.props.my_id){var n={user_id:this.props.contactUser.id,sender_id:this.props.my_id,message:this.state.message};x.a.sendChatMessage(n).then((function(e){if(e){t.setState({chat_history:e});var a=document.getElementById("chat-messages_"+t.props.contactUser.id),n=document.getElementById("chat-messages-lists_"+t.props.contactUser.id);n&&n.clientHeight&&(a.scrollTop=n.clientHeight)}else w.a.showError("Send chat message")}))}this.setState({message:""})}},{key:"uploadFile",value:function(e){var t=this,a=new FormData;a.append("files",e),a.append("user_id",this.props.contactUser.id),a.append("sender_id",this.props.my_id),y.a.post("/ajax/chat/fileupload",a,{onUploadProgress:function(e){t.setState({uploading_progress:e.loaded/e.total,uploading:!0})}}).then((function(e){e?t.setState({uploading:!1,uploading_progress:0,chat_history:e},(function(){document.getElementById("chat-messages_"+t.props.contactUser.id).scrollTop=document.getElementById("chat-messages-lists_"+t.props.contactUser.id).clientHeight})):w.a.showError("Upload file")})).catch((function(e){t.setState({uploading:!1,uploading_progress:0})}))}},{key:"uploadFileFromClipboard",value:function(e){this.uploadFile(e)}},{key:"fileChange",value:function(e){e.preventDefault(),this.uploadFile(e.target.files[0])}},{key:"openBox",value:function(){this.setState({is_open:!this.state.is_open})}},{key:"chatKeyPress",value:function(e){var t=this;if("Enter"===e.key){e.preventDefault();var a=this.state.chat_history;if(a.push({user_id:this.props.contactUser.id,sender_id:this.props.my_id,type:"text",message:this.state.message,sender_profile_picture:this.props.my_profile_pic}),this.setState({chat_history:a},(function(){var e=document.getElementById("chat-messages_"+t.props.contactUser.id),a=document.getElementById("chat-messages-lists_"+t.props.contactUser.id);a&&a.clientHeight&&(e.scrollTop=a.clientHeight)})),this.props.my_id){var n={user_id:this.props.contactUser.id,sender_id:this.props.my_id,message:this.state.message};x.a.sendChatMessage(n).then((function(e){if(e){t.setState({chat_history:e});var a=document.getElementById("chat-messages_"+t.props.contactUser.id),n=document.getElementById("chat-messages-lists_"+t.props.contactUser.id);n&&n.clientHeight&&(a.scrollTop=n.clientHeight)}else w.a.showError("Send chat message")}))}this.setState({message:""})}else if(N){var s={user_id:this.props.contactUser.id,sender_id:this.props.my_id};x.a.sendTypingStatus(s).then((function(e){})),N=!1,setTimeout((function(){N=!0}),200)}this.props.onTyping()}},{key:"chatKeyChange",value:function(e){this.setState({message:e.target.value})}},{key:"handleTogglekbactive",value:function(){this.setState({kbactive:!this.state.kbactive})}},{key:"render",value:function(){return d.a.createElement("div",{className:"body-main-chat"},d.a.createElement("div",{className:"body-expand-header"},d.a.createElement("div",{className:"body-expand-back"},d.a.createElement("button",{onClick:this.props.closeChatBox},d.a.createElement(p.a,{icon:m.i}))),d.a.createElement("div",{className:"body-expand-team"},d.a.createElement("div",{className:"body-expand-teamimg"},d.a.createElement("img",{src:this.props.contactUser.profile_picture.src,alt:"contact user"})),d.a.createElement("div",{className:"body-expand-teamname"},d.a.createElement("h4",null,this.props.contactUser.full_name),d.a.createElement("p",null," ",this.props.contactUser.live)))),d.a.createElement("div",{className:"body-conversation-middle",id:"chat-messages_"+this.props.contactUser.id},d.a.createElement(S,{is_typing:this.state.is_typing,chat_history:this.state.chat_history,chatUser:this.props.contactUser.id})),d.a.createElement("div",{className:"body-conversation-footer"},this.state.uploading?d.a.createElement(_.a,{completed:100*this.state.uploading_progress}):null,d.a.createElement("div",{className:this.state.kbactive?"body-conversation-inner ":"body-conversation-inner kbactive",onClick:this.handleTogglekbactive},d.a.createElement("textarea",{onPaste:this.handlePaste,type:"text",className:"chatinput",placeholder:"Send message...",value:this.state.message,onKeyPress:this.chatKeyPress,onChange:this.chatKeyChange}),d.a.createElement("div",{className:"body-conversation-button"},d.a.createElement("div",{className:"body-button-upload"},d.a.createElement("label",{htmlFor:"file"+this.props.contactUser.id},d.a.createElement(p.a,{icon:m.u})),d.a.createElement("input",{type:"file",onChange:this.fileChange,id:"file"+this.props.contactUser.id})),d.a.createElement("div",{className:"body-conversation-submit"},d.a.createElement("button",{type:"button",onClick:this.handleSendMessage},d.a.createElement(p.a,{icon:m.A})))))))}}]),t}(d.a.PureComponent),I=(a(1063),new u.a("ccd81a8b36efcabe5a7b",{cluster:"mt1",encrypted:!0,disableStats:!0})),T=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).state={isLogedIn:O.a.isSigned(),contacts:[],chatbox:null,active_chatbox:null,show_chatbox:!0,open_chat_box:!1},a.openChat=a.openChat.bind(Object(i.a)(a)),a.closeChatBox=a.closeChatBox.bind(Object(i.a)(a)),a.handleBoxOpen=a.handleBoxOpen.bind(Object(i.a)(a)),a.archiveContact=a.archiveContact.bind(Object(i.a)(a)),a.activeContact=a.activeContact.bind(Object(i.a)(a)),a.blockContact=a.blockContact.bind(Object(i.a)(a)),a.blockContact=a.blockContact.bind(Object(i.a)(a)),a.unblockContact=a.unblockContact.bind(Object(i.a)(a)),a.deleteContact=a.deleteContact.bind(Object(i.a)(a)),a.activeChatBox=a.activeChatBox.bind(Object(i.a)(a)),a.notifySoundUrl="https://res.cloudinary.com/vacation-rentals/video/upload/v1554130121/audio/alarm.mp3",a.notifySound=new Audio(a.notifySoundUrl),a}return Object(r.a)(t,e),Object(s.a)(t,[{key:"activeChatBox",value:function(e){this.setState({active_chatbox:e})}},{key:"openChat",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=null;this.state.contacts.map((function(a){return a.id===e?t=a:null})),this.setState({chatbox:e,contactUser:t,open_chat_box:!0,show_chatbox:!0})}},{key:"closeChatBox",value:function(){this.setState({chatbox:null})}},{key:"componentDidMount",value:function(){var e=this;!0===this.state.isLogedIn&&(x.a.getContactLists().then((function(t){t?e.setState({contacts:t}):w.a.showError("Get contact list")})),I.subscribe("chat_"+Object(j.i)("user_id")).bind("App\\Events\\MessageSent",(function(t){if(t.message.message.sender_id!==e.state.active_contact){w.a.showSuccess("You received new message from "+t.message.message.sender.full_name);var a=e,n=e.notifySound.play();null!==n&&n.catch((function(){a.notifySound.play()}))}})),this.props.chatmoduleReducer&&("undefined"!==this.props.chatmoduleReducer.is_show&&!0===this.props.chatmoduleReducer.is_show?(document.getElementById("footer").style.display="block",this.setState({show_chatbox:!0},(function(){}))):(document.getElementById("footer").style.display="none",this.setState({show_chatbox:!1,open_chat_box:!1},(function(){}))),this.props.chatmoduleReducer.contactId&&(console.log("open chat tracking",this.props.chatmoduleReducer.contactId),x.a.getContactLists().then((function(t){t?e.setState({contacts:t.data},(function(){var t=e.props.chatmoduleReducer.contactId;e.state.contacts.foreach((function(a){a.contact_id===t&&e.setState({open_chat_box:!0,show_chatbox:!0},(function(){e.openChat(a.id,1)}))}))})):w.a.showError("Get contact list")})))))}},{key:"componentWillUnmount",value:function(){I.unsubscribe("chat_"+Object(j.i)("user_id"))}},{key:"archiveContact",value:function(e){var t=this,a={contactId:e,status:"archived",userId:Object(j.i)("user_id")};x.a.updateContactStatus(a).then((function(e){e?t.setState({contacts:e}):w.a.showError("Update contact status")}))}},{key:"activeContact",value:function(e){var t=this;console.log(e);var a={contactId:e,status:"active",userId:Object(j.i)("user_id")};x.a.updateContactStatus(a).then((function(e){e?t.setState({contacts:e}):w.a.showError("Update contact status")}))}},{key:"blockContact",value:function(e){var t=this,a={contactId:e,status:"blocked",userId:Object(j.i)("user_id")};x.a.updateContactStatus(a).then((function(e){e?t.setState({contacts:e}):w.a.showError("Update contact status")}))}},{key:"unblockContact",value:function(e){var t=this,a={contactId:e,status:"active",userId:Object(j.i)("user_id")};x.a.updateContactStatus(a).then((function(e){e?t.setState({contacts:e}):w.a.showError("Update contact status")}))}},{key:"deleteContact",value:function(e){var t=this,a={contactId:e,status:"removed",userId:Object(j.i)("user_id")};x.a.updateContactStatus(a).then((function(e){e?t.setState({contacts:e}):w.a.showError("Update contact status")}))}},{key:"handleBoxOpen",value:function(){this.setState({open_chat_box:!this.state.open_chat_box})}},{key:"render",value:function(){var e=this;return!0===this.state.isLogedIn&&!0===this.state.show_chatbox?d.a.createElement("div",{className:"chat-box"},d.a.createElement("div",{className:(this.state.open_chat_box?"chat-window chat-window-open":"chat-window")+(this.state.chatbox?" inner-open":"")},d.a.createElement("div",{className:"chat-conversation"},d.a.createElement("div",{className:"chat-head"},d.a.createElement("div",null,d.a.createElement("div",{className:"chat-head-view-enter"},d.a.createElement("div",{className:"chat-head-view-head"},d.a.createElement("h3",null,"Hi there ",d.a.createElement("span",{role:"img","aria-label":"sheep"},"\ud83d\udc4b")),d.a.createElement("p",null,"Helping Vacation.Rentals Owners Property Managers for Over 5 Years. Got a Question? Or Just Saying Hi? Send us a Message."))))),d.a.createElement("div",{className:"chat-body"},d.a.createElement("div",{className:"body-fixed"},d.a.createElement("div",{className:"body-main"},d.a.createElement("div",{className:"body-main-wrap"},d.a.createElement("div",{className:"body-main-card"},d.a.createElement("div",{className:"body-main-conve"},d.a.createElement("div",{className:"body-main-content"},d.a.createElement("div",{className:"body-main-con"},d.a.createElement(v,{contacts:this.state.contacts,openChat:this.openChat,active:this.activeContact,archive:this.archiveContact,block:this.blockContact,unblock:this.unblockContact,delete:this.deleteContact}))),d.a.createElement("div",{className:"body-main-footer"},d.a.createElement("a",{className:"btn btn-outline-primary",href:"/inbox"},d.a.createElement(p.a,{icon:m.j}),"Go to Inbox"," "))),this.state.chatbox&&d.a.createElement(B,{closeChatBox:this.closeChatBox,isActive:1,onTyping:function(){return e.activeChatBox(e.state.contactUser.id)},contactUser:this.state.contactUser,my_id:Object(j.i)("user_id"),my_profile_pic:Object(j.i)("userProfilePic"),user_id:this.state.chatbox,openChat:function(){return e.openChat(e.state.chatbox)}})))))))),d.a.createElement("div",{className:this.state.open_chat_box?"chat-footer open":"chat-footer",onClick:this.handleBoxOpen},d.a.createElement(p.a,{icon:m.j}),d.a.createElement(p.a,{icon:m.J}))):null}}]),t}(d.a.Component);t.default=T},199:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),s=a(5),c=a(7),o=new(function(){function e(){Object(n.a)(this,e)}return Object(s.a)(e,[{key:"getContactLists",value:function(){return Object(c.d)("".concat(c.a,"/ajax/chat/getcontactlists?userId=")+Object(c.i)("user_id"))}},{key:"updateContactStatus",value:function(e){return""}},{key:"updateFile",value:function(e){return""}},{key:"getMessages",value:function(e,t){return Object(c.d)("".concat(c.a,"/ajax/chat/getmessages?chat_id=").concat(e,"&my_id=").concat(t))}},{key:"readChatMessage",value:function(e){return""}},{key:"sendChatMessage",value:function(e){return""}},{key:"sendTypingStatus",value:function(e){return""}},{key:"getMail",value:function(e){return""}}]),e}())}}]);
//# sourceMappingURL=36.51092a6c.chunk.js.map